{
  "s3": {
    "buckets": [
      {
        "Name": "loki-logs"
      },
      {
        "Name": "docker-registry"
      },
      {
        "Name": "db-backups"
      },
      {
        "Name": "frontend",
        "policy": "static-files"
      }
    ],
    "policies": {
      "loki": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Action": [
              "s3:PutObject",
              "s3:GetObject",
              "s3:DeleteObject",
              "s3:ListBucket"
            ],
            "Effect": "Allow",
            "Resource": ["arn:aws:s3:::loki-logs/*", "arn:aws:s3:::loki-logs"]
          },
          {
            "Action": ["s3:ListBucket"],
            "Effect": "Allow",
            "Resource": ["arn:aws:s3:::loki-logs"]
          }
        ]
      },
      "registry": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Action": [
              "s3:ListBucket",
              "s3:GetBucketLocation",
              "s3:ListBucketMultipartUploads"
            ],
            "Resource": ["arn:aws:s3:::docker-registry"]
          },
          {
            "Effect": "Allow",
            "Action": [
              "s3:PutObject",
              "s3:GetObject",
              "s3:DeleteObject",
              "s3:ListMultipartUploadParts",
              "s3:AbortMultipartUpload"
            ],
            "Resource": ["arn:aws:s3:::docker-registry/*"]
          }
        ]
      },
      "backups": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Action": ["s3:PutObject"],
            "Resource": ["arn:aws:s3:::db-backups"]
          }
        ]
      },
      "static-files": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Principal": { "AWS": ["*"] },
            "Action": ["s3:GetBucketLocation", "s3:ListBucket"],
            "Resource": ["arn:aws:s3:::frontend"]
          },
          {
            "Effect": "Allow",
            "Principal": {
              "AWS": ["*"]
            },
            "Action": ["s3:GetObject"],
            "Resource": [
              "arn:aws:s3:::frontend/*",
              "arn:aws:s3:::frontend/latest/*",
              "arn:aws:s3:::frontend/dev/*",
              "arn:aws:s3:::frontend/git:*/*"
            ]
          },
          {
            "Effect": "Allow",
            "Principal": {
              "AWS": ["*"]
            },
            "Action": ["s3:ListBucket"],
            "Resource": ["arn:aws:s3:::frontend"],
            "Condition": {
              "StringEquals": {
                "s3:prefix": [
                  "latest",
                  "dev",
                  "git:*"
                ]
              }
            }
          }
        ]
      }
    },
    "groups": []
  },
  "db": {
    "Users": [],
    "Databases": [
      {
        "Name": "grafana",
        "Owner": "grafana"
      }
    ]
  }
}
