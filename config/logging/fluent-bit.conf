[SERVICE]
    # log_level debug
    # import parsers defined in a parsers file
    Parsers_File /fluent-bit/etc/parsers.conf

# collect docker logs using fluend logging driver
[INPUT]
    Name forward
    Listen 0.0.0.0
    port 24224

# [INPUT]
#     Name mem
#     Tag mem.local
#     Interval_Sec 15
# [INPUT]
#     Name cpu
#     Tag cpu.local
#     Interval_Sec 15

# try parsing log as json and lift its keys to the first-level
[FILTER]
    Name parser
    Parser json
    Match *
    Key_Name log
    Reserve_Data On

[FILTER]
    Name record_modifier
    Match *
    Record hostname ${HOSTNAME}

[OUTPUT]
    Name loki
    Match *
    labels job=fluentbit
    host loki
    port 3100
    http_user admin
    http_passwd admin
    tls off
    tls.verify off

# [OUTPUT]
#     Name stdout
#     Match *
