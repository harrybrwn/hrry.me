{"meta":{"type":"db","canSave":false,"canEdit":false,"canAdmin":false,"canStar":true,"canDelete":false,"slug":"container-registry","url":"/d/X9CPPsj7k/container-registry","expires":"0001-01-01T00:00:00Z","created":"2022-06-16T00:26:16Z","updated":"2022-06-22T00:00:40Z","updatedBy":"admin","createdBy":"admin","version":21,"hasAcl":false,"isFolder":false,"folderId":0,"folderUid":"","folderTitle":"General","folderUrl":"","provisioned":false,"provisionedExternalId":"dashboards/registry.json","annotationsPermissions":{"dashboard":{"canAdd":true,"canEdit":true,"canDelete":true},"organization":{"canAdd":false,"canEdit":false,"canDelete":false}},"isPublic":false},"dashboard":{"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","target":{"limit":100,"matchAny":false,"tags":[],"type":"dashboard"},"type":"dashboard"}]},"description":"Docker container registry.","editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":7,"iteration":1655845302285,"links":[],"liveNow":false,"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":16,"panels":[],"title":"Requests","type":"row"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":9,"w":12,"x":0,"y":1},"id":2,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"sum without (job) (rate(registry_http_requests_total{handler=~\"$handler\"}[$__rate_interval]))","hide":false,"range":true,"refId":"A"}],"title":"HTTP Requests","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"fillOpacity":80,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineWidth":1},"mappings":[],"thresholds":{"mode":"percentage","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":1},"id":10,"options":{"bucketOffset":0,"legend":{"calcs":[],"displayMode":"list","placement":"bottom"}},"pluginVersion":"8.5.5","targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"histogram_quantile(0.95, sum(rate(registry_http_response_size_bytes_bucket{handler=~\"$handler\"}[$__rate_interval])) by (le))","range":true,"refId":"A"}],"title":"Response Size","type":"histogram"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"fillOpacity":80,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineWidth":1},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":9},"id":12,"options":{"bucketOffset":0,"legend":{"calcs":[],"displayMode":"list","placement":"bottom"}},"pluginVersion":"8.5.5","targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"histogram_quantile(0.95, sum(rate(registry_http_request_size_bytes_bucket{handler=~\"$handler\"}[$__rate_interval])) by (le))","range":true,"refId":"A"}],"title":"Request Size","type":"histogram"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":10},"id":14,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"pluginVersion":"8.5.5","targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"sum without (job) (registry_http_in_flight_requests{handler=~\"$handler\"})","hide":false,"range":true,"refId":"A"}],"title":"In Flight Requests","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":18},"id":20,"panels":[],"title":"Cache","type":"row"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":5,"w":3,"x":0,"y":19},"id":24,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"auto"},"pluginVersion":"9.0.1","targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"sum(rate(registry_storage_cache_total{type=\"Hit\"}[$__rate_interval]))","range":true,"refId":"A"}],"title":"Cache Hits","type":"stat"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":5,"w":3,"x":3,"y":19},"id":25,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"auto"},"pluginVersion":"9.0.1","targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"sum(rate(registry_storage_cache_total{type=\"Miss\"}[$__rate_interval]))","range":true,"refId":"A"}],"title":"Cache Misses","type":"stat"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":5,"w":3,"x":6,"y":19},"id":26,"options":{"colorMode":"value","graphMode":"area","justifyMode":"auto","orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"auto"},"pluginVersion":"9.0.1","targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"sum(rate(registry_storage_cache_total{type=\"Request\"}[$__rate_interval]))","range":true,"refId":"A"}],"title":"Cache Requests","type":"stat"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":7,"w":5,"x":12,"y":19},"id":29,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"pluginVersion":"8.5.5","targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"rate(\r\n    registry_storage_cache_total{type=\"Hit\"}[$__rate_interval]\r\n) /\r\nignoring (type) rate(\r\n    registry_storage_cache_total{type=\"Miss\"}[$__rate_interval]\r\n)","hide":false,"refId":"C"}],"title":"Cache Ratio","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":9,"w":12,"x":0,"y":24},"id":28,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"editorMode":"code","expr":"max by (type) (rate(registry_storage_cache_total[$__rate_interval]))","hide":false,"legendFormat":"{{type}}","range":true,"refId":"A"}],"title":"Storage Cache","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":33},"id":18,"panels":[],"title":"Storage","type":"row"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"ops"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":0,"y":34},"id":6,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"multi","sort":"desc"}},"targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"expr":"sum by (action, driver) (rate(registry_storage_action_seconds_count[$__rate_interval]))","hide":false,"range":true,"refId":"A"}],"title":"Storage Op Duration","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"custom":{"fillOpacity":80,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineWidth":1},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":34},"id":8,"options":{"bucketOffset":0,"combine":false,"legend":{"calcs":[],"displayMode":"list","placement":"bottom"}},"targets":[{"datasource":{"type":"prometheus","uid":"${PROM}"},"editorMode":"code","exemplar":false,"expr":"histogram_quantile(0.95, sum(rate(registry_storage_action_seconds_bucket{}[$__rate_interval])) by (le))","format":"time_series","hide":false,"legendFormat":"__auto","range":true,"refId":"A"}],"title":"Storage Op Duration Distrobution","type":"histogram"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":42},"id":31,"panels":[{"datasource":{"type":"loki","uid":"${LOKI}"},"gridPos":{"h":22,"w":24,"x":0,"y":43},"id":33,"options":{"dedupStrategy":"none","enableLogDetails":true,"prettifyLogMessage":false,"showCommonLabels":false,"showLabels":false,"showTime":false,"sortOrder":"Descending","wrapLogMessage":false},"targets":[{"datasource":{"type":"loki","uid":"${LOKI}"},"expr":"{type=\"logs\", service=\"registry\"}","refId":"A"}],"title":"Logs","type":"logs"},{"datasource":{"type":"loki","uid":"P982945308D3682D1"},"gridPos":{"h":15,"w":24,"x":0,"y":65},"id":35,"options":{"dedupStrategy":"none","enableLogDetails":true,"prettifyLogMessage":false,"showCommonLabels":false,"showLabels":false,"showTime":false,"sortOrder":"Descending","wrapLogMessage":false},"targets":[{"datasource":{"type":"loki","uid":"P982945308D3682D1"},"expr":"{type=\"logs\", service=\"nginx\"} | json server_name=\"registry.hrry.dev\"","refId":"A"}],"title":"Access Logs","type":"logs"}],"title":"Logs","type":"row"}],"refresh":"30s","schemaVersion":36,"style":"dark","tags":["docker","registry"],"templating":{"list":[{"current":{"selected":false,"text":"prometheus","value":"prometheus"},"description":"Prometheus Datasource","hide":1,"includeAll":false,"label":"","multi":false,"name":"PROM","options":[],"query":"prometheus","queryValue":"","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"},{"current":{"selected":false,"text":"loki","value":"loki"},"description":"Loki Logs Database","hide":0,"includeAll":false,"multi":false,"name":"LOKI","options":[],"query":"loki","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"},{"current":{"selected":false,"text":"All","value":"$__all"},"datasource":{"type":"prometheus","uid":"${PROM}"},"definition":"label_values(registry_http_requests_total, handler)","description":"HTTP Handlers","hide":0,"includeAll":true,"multi":false,"name":"handler","options":[],"query":{"query":"label_values(registry_http_requests_total, handler)","refId":"StandardVariableQuery"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"type":"query"}]},"time":{"from":"now-30m","to":"now"},"timepicker":{},"timezone":"","title":"Container Registry","uid":"X9CPPsj7k","version":21,"weekStart":""}}
