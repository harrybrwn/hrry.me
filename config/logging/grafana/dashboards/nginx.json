{"annotations":{"list":[{"builtIn":1,"datasource":{"type":"datasource","uid":"grafana"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","target":{"limit":100,"matchAny":false,"tags":[],"type":"dashboard"},"type":"dashboard"}]},"description":"Official dashboard for NGINX Prometheus exporter","editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":4,"iteration":1655357382353,"links":[],"liveNow":false,"panels":[{"collapsed":false,"datasource":{"uid":"${DS_PROMETHEUS}"},"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":4,"panels":[],"title":"Status","type":"row"},{"datasource":{"uid":"${DS_PROMETHEUS}"},"description":"","fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[{"options":{"0":{"text":"Down"},"1":{"text":"Up"}},"type":"value"}],"thresholds":{"mode":"absolute","steps":[{"color":"#E02F44","value":null},{"color":"#FF9830","value":1},{"color":"#299c46","value":1}]},"unit":"none"},"overrides":[]},"gridPos":{"h":3,"w":24,"x":0,"y":1},"id":8,"links":[],"maxDataPoints":100,"options":{"colorMode":"background","graphMode":"none","justifyMode":"auto","orientation":"horizontal","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"textMode":"auto"},"pluginVersion":"8.5.5","repeat":"instance","repeatDirection":"h","targets":[{"expr":"nginx_up{instance=~\"$instance\"}","format":"time_series","instant":false,"intervalFactor":1,"refId":"A"}],"title":"NGINX Status for $instance","type":"stat"},{"collapsed":false,"datasource":{"uid":"${DS_PROMETHEUS}"},"gridPos":{"h":1,"w":24,"x":0,"y":4},"id":6,"panels":[],"title":"Metrics","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":{"uid":"${DS_PROMETHEUS}"},"description":"","fill":1,"fillGradient":0,"gridPos":{"h":10,"w":12,"x":0,"y":5},"hiddenSeries":false,"id":10,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.5.5","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(nginx_connections_accepted{instance=~\"$instance\"}[5m])","format":"time_series","instant":false,"intervalFactor":1,"legendFormat":"{{instance}} accepted","refId":"A"},{"expr":"irate(nginx_connections_handled{instance=~\"$instance\"}[5m])","format":"time_series","instant":false,"intervalFactor":1,"legendFormat":"{{instance}} handled","refId":"B"}],"thresholds":[],"timeRegions":[],"title":"Processed connections","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"decimals":1,"format":"short","label":"Connections (rate)","logBase":1,"show":true},{"format":"short","label":"","logBase":1,"show":true}],"yaxis":{"align":false}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":{"uid":"${DS_PROMETHEUS}"},"decimals":0,"fill":1,"fillGradient":0,"gridPos":{"h":10,"w":12,"x":12,"y":5},"hiddenSeries":false,"id":12,"legend":{"alignAsTable":false,"avg":false,"current":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.5.5","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"nginx_connections_active{instance=~\"$instance\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{instance}} active","refId":"A"},{"expr":"nginx_connections_reading{instance=~\"$instance\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{instance}} reading","refId":"B"},{"expr":"nginx_connections_waiting{instance=~\"$instance\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{instance}} waiting","refId":"C"},{"expr":"nginx_connections_writing{instance=~\"$instance\"}","format":"time_series","intervalFactor":1,"legendFormat":"{{instance}} writing","refId":"D"}],"thresholds":[],"timeRegions":[],"title":"Active Connections","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":"Connections","logBase":1,"show":true},{"format":"short","logBase":1,"show":true}],"yaxis":{"align":false}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":{"uid":"${DS_PROMETHEUS}"},"fill":1,"fillGradient":0,"gridPos":{"h":8,"w":24,"x":0,"y":15},"hiddenSeries":false,"id":15,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"8.5.5","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(nginx_http_requests_total{instance=~\"$instance\"}[5m])","format":"time_series","intervalFactor":1,"legendFormat":"{{instance}} total requests","refId":"A"}],"thresholds":[],"timeRegions":[],"title":"Total requests","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"show":true},{"format":"short","logBase":1,"show":true}],"yaxis":{"align":false}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":23},"id":19,"panels":[],"title":"Logs","type":"row"},{"datasource":{"type":"loki","uid":"P982945308D3682D1"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[]},"gridPos":{"h":6,"w":3,"x":0,"y":24},"id":24,"options":{"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":false},"pluginVersion":"8.5.5","targets":[{"datasource":{"type":"loki","uid":"P982945308D3682D1"},"expr":"sum(count_over_time({service=\"nginx\"}[$__range]))","refId":"A"}],"title":"Logs Count","type":"gauge"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[]},"gridPos":{"h":7,"w":5,"x":3,"y":24},"id":21,"options":{"displayMode":"gradient","minVizHeight":10,"minVizWidth":0,"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showUnfilled":false},"pluginVersion":"8.5.5","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"expr":"sum by (method) (\n  count_over_time({service=\"nginx\"} | json [$__range])\n)","legendFormat":"{{method}}","refId":"A"}],"title":"Request Method","type":"bargauge"},{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]}},"overrides":[]},"gridPos":{"h":7,"w":16,"x":8,"y":24},"id":22,"options":{"displayMode":"gradient","minVizHeight":10,"minVizWidth":0,"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showUnfilled":false},"pluginVersion":"8.5.5","targets":[{"datasource":{"type":"loki","uid":"${DS_LOKI}"},"expr":"sum by (cf_ipcountry) (\n  count_over_time({service=\"nginx\"} | json [$__range])\n)","legendFormat":"{{cf_ipcountry}}","refId":"A"}],"title":"Country Code","transformations":[],"type":"bargauge"},{"datasource":{"type":"loki","uid":"P982945308D3682D1"},"gridPos":{"h":16,"w":24,"x":0,"y":31},"id":17,"options":{"dedupStrategy":"none","enableLogDetails":true,"prettifyLogMessage":false,"showCommonLabels":false,"showLabels":false,"showTime":true,"sortOrder":"Descending","wrapLogMessage":false},"targets":[{"datasource":{"type":"loki","uid":"P982945308D3682D1"},"expr":"{type=\"logs\", container_name =~ \"^/.*_nginx.*$\" }\n  | json\n  | server_name !~ \"grafana.*\"","refId":"A"}],"title":"nginx logs","type":"logs"}],"refresh":"1m","schemaVersion":36,"style":"dark","tags":["nginx","prometheus","nginx prometheus exporter"],"templating":{"list":[{"current":{"selected":false,"text":"prometheus","value":"prometheus"},"hide":0,"includeAll":false,"label":"datasource","multi":false,"name":"DS_PROMETHEUS","options":[],"query":"prometheus","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"},{"current":{"selected":false,"text":"loki","value":"loki"},"hide":0,"includeAll":false,"label":"datasource","multi":false,"name":"DS_LOKI","options":[],"query":"loki","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"},{"current":{"selected":false,"text":"All","value":"$__all"},"datasource":{"type":"loki","uid":"${DS_PROMETHEUS}"},"definition":"label_values(nginx_up, instance)","hide":0,"includeAll":true,"label":"","multi":true,"name":"instance","options":[],"query":{"query":"label_values(nginx_up, instance)","refId":"prometheus-instance-Variable-Query"},"refresh":1,"regex":"","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-30m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"NGINX","uid":"MsjffzSZz","version":4,"weekStart":""}
