{"annotations":{"list":[{"builtIn":1,"datasource":{"type":"grafana","uid":"-- Grafana --"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","target":{"limit":100,"matchAny":false,"tags":[],"type":"dashboard"},"type":"dashboard"}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":10,"iteration":1656059489720,"links":[],"liveNow":false,"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":11,"panels":[],"title":"Prometheus","type":"row"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":5,"w":3,"x":0,"y":1},"id":13,"options":{"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true},"pluginVersion":"9.0.1","targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"avg (rate(scrape_duration_seconds{}[$__range]))","range":true,"refId":"A"}],"title":"Average Scrape Time","type":"gauge"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":5,"w":4,"x":12,"y":1},"id":5,"options":{"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true},"pluginVersion":"9.0.1","targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"avg(rate(prometheus_engine_query_duration_seconds_sum[$__range]))","hide":false,"refId":"C"}],"title":"Prometheus Average Query Time","type":"gauge"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":2,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"percentage","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":11,"w":12,"x":0,"y":6},"id":2,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"multi","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"editorMode":"code","expr":"avg by (job) (scrape_duration_seconds{})","legendFormat":"{{job}}","range":true,"refId":"A"}],"title":"Scrape Time","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":11,"w":12,"x":12,"y":6},"id":4,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"prometheus_engine_query_duration_seconds","hide":true,"range":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"sum(rate(prometheus_engine_query_duration_seconds_sum[$__rate_interval]))","hide":false,"refId":"B"}],"title":"Prometheus Query Time","type":"timeseries"},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":17},"id":9,"panels":[],"title":"Loki","type":"row"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"thresholds"},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null}]},"unit":"bytes"},"overrides":[]},"gridPos":{"h":8,"w":3,"x":0,"y":18},"id":15,"options":{"orientation":"auto","reduceOptions":{"calcs":["lastNotNull"],"fields":"","values":false},"showThresholdLabels":false,"showThresholdMarkers":true},"pluginVersion":"9.0.1","targets":[{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"loki_chunk_store_stored_chunk_bytes_total","hide":false,"refId":"C"}],"title":"Stored Chunk Bytes","type":"gauge"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":18},"id":18,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"rate(loki_s3_request_duration_seconds_sum[$__rate_interval])","hide":false,"range":true,"refId":"A"}],"title":"S3 Request Duration","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":9,"w":10,"x":0,"y":26},"id":7,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"loki_cache_hits{} / loki_cache_fetched_keys{}","hide":false,"range":true,"refId":"C"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"avg by (name) (rate(loki_cache_hits[$__rate_interval]))\r\n/\r\navg by (name) (rate(loki_cache_fetched_keys[$__rate_interval]))","hide":true,"refId":"D"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"avg by (name) (rate(loki_cache_hits[$__range]))\r\n/\r\navg by (name) (rate(loki_cache_fetched_keys[$__range]))","hide":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"avg by (name) (rate(loki_cache_hits[$__rate_interval]))\r\n/\r\navg by (name) (rate(loki_cache_fetched_keys[$__rate_interval]))","hide":true,"refId":"B"}],"title":"Loki Cache Hit Rate","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":26},"id":20,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"avg by (route, method) (rate(loki_request_duration_seconds_sum{method!=\"gRPC\", route!=\"metrics\"}[$__rate_interval]))","hide":false,"refId":"A"}],"title":"HTTP Request Duration","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":34},"id":24,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"sum by (operation, status_code) (rate(loki_boltdb_shipper_request_duration_seconds_sum[$__rate_interval]))","hide":false,"refId":"B"}],"title":"BoltDB Shipper Request Duration","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":10,"x":0,"y":35},"id":17,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"rate(loki_s3_request_duration_seconds_sum[$__rate_interval])","hide":true,"range":true,"refId":"A"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"rate(loki_chunk_store_index_entries_per_chunk_count[$__rate_interval])","hide":false,"refId":"C"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"sum (rate(loki_chunk_store_index_lookups_per_query_sum[$__rate_interval]))","hide":true,"refId":"D"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"rate(loki_chunk_store_chunks_per_query_sum[$__rate_interval])","hide":true,"refId":"E"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"rate(loki_request_duration_seconds_count{method!=\"gRPC\"}[$__rate_interval])","hide":true,"refId":"F"}],"title":"Index Entries per Chunk","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":42},"id":25,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"rate(loki_querier_query_frontend_request_duration_seconds_sum[$__rate_interval])","hide":false,"refId":"A"}],"title":"Frontend Query Duration","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":9,"w":10,"x":0,"y":43},"id":21,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"rate(loki_chunk_store_index_lookups_per_query_count[$__rate_interval])","hide":false,"refId":"E"}],"title":"Index Lookups per Query","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]},"unit":"s"},"overrides":[]},"gridPos":{"h":8,"w":12,"x":12,"y":50},"id":27,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"rate(loki_logql_querystats_latency_seconds_sum[$__rate_interval])","hide":false,"refId":"B"}],"title":"LogQL Query Latency","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":9,"w":10,"x":0,"y":52},"id":19,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"expr":"rate(loki_chunk_store_chunks_per_query_sum[$__rate_interval])","hide":false,"refId":"E"}],"title":"Chunks per Query","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":9,"w":10,"x":0,"y":61},"id":23,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"loki_index_chunk_refs_total","range":true,"refId":"A"}],"title":"Chunk References in Index","type":"timeseries"},{"datasource":{"type":"prometheus","uid":"${DS_PROM}"},"fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisLabel":"","axisPlacement":"auto","barAlignment":0,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"auto","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"thresholds":{"mode":"absolute","steps":[{"color":"green","value":null},{"color":"red","value":80}]}},"overrides":[]},"gridPos":{"h":8,"w":10,"x":0,"y":70},"id":29,"options":{"legend":{"calcs":[],"displayMode":"list","placement":"bottom"},"tooltip":{"mode":"single","sort":"none"}},"targets":[{"datasource":{"type":"prometheus","uid":"P1809F7CD0C75ACF3"},"expr":"loki_chunk_store_stored_chunks_total","range":true,"refId":"A"}],"title":"Stored Chunks","type":"timeseries"}],"refresh":false,"schemaVersion":36,"style":"dark","tags":[],"templating":{"list":[{"current":{"selected":true,"text":"prometheus","value":"prometheus"},"hide":0,"includeAll":false,"multi":false,"name":"DS_PROM","options":[],"query":"prometheus","queryValue":"","refresh":1,"regex":"","skipUrlSync":false,"type":"datasource"}]},"time":{"from":"now-6h","to":"now"},"timepicker":{},"timezone":"","title":"Observability Meta","uid":"n-VhV_j7z","version":13,"weekStart":""}
